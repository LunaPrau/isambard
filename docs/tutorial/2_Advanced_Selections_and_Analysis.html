

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced Selections and Analysis &mdash; ISAMBARD 1.4.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ISAMBARD 1.4.1 documentation" href="../index.html"/>
        <link rel="up" title="Tutorial" href="tutorial.html"/>
        <link rel="next" title="Making Models With Isambard" href="MakingModels.html"/>
        <link rel="prev" title="An Introduction to the AMPAL Framework" href="1_AMPAL_Introduction_and_Selections.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ISAMBARD
          

          
          </a>

          
            
            
              <div class="version">
                2016.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_AMPAL_Introduction_and_Selections.html">An Introduction to the AMPAL Framework</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Advanced Selections and Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selecting-secondary-structure">1. Selecting Secondary Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-all-residues-or-atoms">2. Selecting All Residues or Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysing-composition">3. Analysing Composition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distance-analysis">4. Distance Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#is-within">5. Is Within</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geometry-in-isambard">6. Geometry in ISAMBARD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary-and-activities">7. Summary and activities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MakingModels.html">Making Models With Isambard</a></li>
<li class="toctree-l2"><a class="reference internal" href="AMPALTagging.html">Tagging in the AMPAL framework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing_isambard.html">Citing ISAMBARD</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ISAMBARD</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorial.html">Tutorial</a> &raquo;</li>
        
      <li>Advanced Selections and Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/2_Advanced_Selections_and_Analysis.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-selections-and-analysis">
<h1>Advanced Selections and Analysis<a class="headerlink" href="#advanced-selections-and-analysis" title="Permalink to this headline">¶</a></h1>
<p>There are lots of tools in <code class="docutils literal"><span class="pre">isambard</span></code> for analysing protein structure,
most of them are baked into the AMPAL objects themselves.</p>
<div class="section" id="selecting-secondary-structure">
<h2>1. Selecting Secondary Structure<a class="headerlink" href="#selecting-secondary-structure" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s load-up a PDB file:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">isambard</span>
<span class="n">my_protein_3qy1</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">ampal</span><span class="o">.</span><span class="n">convert_pdb_to_ampal</span><span class="p">(</span><span class="s1">&#39;3qy1.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can select all the helices or strands simply by typing:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">helices</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 20 Polypeptides&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">strands</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 10 Polypeptides&gt;
</pre></div>
</div>
<p>These attributes return <code class="docutils literal"><span class="pre">Assembly</span></code> objects, where each of the
helices/strands are represented as a separate <code class="docutils literal"><span class="pre">Polypeptide</span></code>. All of
the normal attributes and methods associated with <code class="docutils literal"><span class="pre">Assembly</span></code> and
<code class="docutils literal"><span class="pre">Polypeptide</span></code> objects work just the same as before.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span> <span class="o">=</span> <span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">helices</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="o">.</span><span class="n">sequences</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;IDTLISNNALWSKMLVEE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GFFEKLA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AERLT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LNCLSVVQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GGIKAAVE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;INNWLLHIRDIWLK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SSLLG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;RLDALYELNVMEQVYNLGH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;TIMQSAWK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;RETLENGYHKGISALSLKY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IDTLISNNALWSKMLVEE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GFFEKLAQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AERLT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LNCLSVVQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GGIKAAVE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;INNWLLHIRDIWLK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SSLLG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;RLDALYELNVMEQVYNLGH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;TIMQSAWK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;RETLENGYHKGISALSLKY&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 18 Residues. Sequence: IDTLISNNALWS...&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequence</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;IDTLISNNALWSKMLVEE&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">molecular_weight</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">2076.36968</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 7 Atoms. Residue code: VAL&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">15</span><span class="p">][</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Carbon Atom (CA). Coordinates: (23.340, -8.324, -33.970)&gt;
</pre></div>
</div>
<p>It is worth noting that the <code class="docutils literal"><span class="pre">ampal_parent</span></code> attribute of the individual
helix refers to the <code class="docutils literal"><span class="pre">Polypeptide</span></code> to which it belongs.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helix</span> <span class="o">=</span> <span class="n">my_helices_3qy1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helix</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 215 Residues. Sequence: DIDTLISNNALW...&gt;
</pre></div>
</div>
<p>To get back to the original <code class="docutils literal"><span class="pre">Assembly</span></code>, therefore, we call
<code class="docutils literal"><span class="pre">ampal_parent</span></code> twice.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helix</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 2 Polypeptides, 449 Ligands&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helix</span><span class="o">.</span><span class="n">ampal_parent</span> <span class="o">==</span> <span class="n">my_helices_3qy1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">False</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helix</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">ampal_parent</span> <span class="o">==</span> <span class="n">my_protein_3qy1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">True</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-all-residues-or-atoms">
<h2>2. Selecting All Residues or Atoms<a class="headerlink" href="#selecting-all-residues-or-atoms" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it&#8217;s convinient to select all of the <code class="docutils literal"><span class="pre">Residues</span></code> or <code class="docutils literal"><span class="pre">Atoms</span></code>
in an <code class="docutils literal"><span class="pre">Assembly</span></code> or <code class="docutils literal"><span class="pre">Polypeptide</span></code> object:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">get_monomers</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;itertools.chain at 0x10e7a1908&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_helices_3qy1</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;itertools.chain at 0x10e7a1860&gt;
</pre></div>
</div>
<p>As you can see an itertools object is returned. This might be slightly
confusing as you might expect a list, but this is what&#8217;s known as an
<code class="docutils literal"><span class="pre">iterator</span></code>, you can loop over it like a list or string, but if you
want to use it repeatedly or examine its contents you&#8217;ll need to convert
it to a list. The advantage of returning an <code class="docutils literal"><span class="pre">iterator</span></code> is that it&#8217;s
much more memory efficient, and these lists could potentially be very
large. If you&#8217;d like to know more about <code class="docutils literal"><span class="pre">iterables</span></code> and <code class="docutils literal"><span class="pre">iterators</span></code>,
as well as related objects called <code class="docutils literal"><span class="pre">generators</span></code>, see the following link
(this is quite advanced Python and is not essential for using any of the
AMPAL framework: <a class="reference external" href="http://anandology.com/python-practice-book/iterators.html">Iterators and
Generators</a>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">())[:</span><span class="mi">20</span><span class="p">]</span>  <span class="c1"># Showing the first 20 elements for clarity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Nitrogen Atom (N). Coordinates: (14.714, -30.168, -26.423)&gt;,
 &lt;Carbon Atom (CA). Coordinates: (15.518, -30.153, -25.207)&gt;,
 &lt;Carbon Atom (C). Coordinates: (16.111, -28.769, -24.931)&gt;,
 &lt;Oxygen Atom (O). Coordinates: (15.960, -27.855, -25.734)&gt;,
 &lt;Carbon Atom (CB). Coordinates: (16.613, -31.220, -25.270)&gt;,
 &lt;Carbon Atom (CG). Coordinates: (16.067, -32.624, -25.153)&gt;,
 &lt;Oxygen Atom (OD1). Coordinates: (14.899, -32.777, -24.743)&gt;,
 &lt;Oxygen Atom (OD2). Coordinates: (16.807, -33.576, -25.474)&gt;,
 &lt;Nitrogen Atom (N). Coordinates: (16.782, -28.637, -23.789)&gt;,
 &lt;Carbon Atom (CA). Coordinates: (17.360, -27.364, -23.339)&gt;,
 &lt;Carbon Atom (C). Coordinates: (18.466, -26.876, -24.299)&gt;,
 &lt;Oxygen Atom (O). Coordinates: (18.513, -25.674, -24.586)&gt;,
 &lt;Carbon Atom (CB). Coordinates: (17.842, -27.509, -21.862)&gt;,
 &lt;Carbon Atom (CG1). Coordinates: (16.643, -27.442, -20.889)&gt;,
 &lt;Carbon Atom (CG2). Coordinates: (18.956, -26.516, -21.456)&gt;,
 &lt;Carbon Atom (CD1). Coordinates: (15.873, -26.033, -20.777)&gt;,
 &lt;Nitrogen Atom (N). Coordinates: (19.310, -27.788, -24.836)&gt;,
 &lt;Carbon Atom (CA). Coordinates: (20.370, -27.411, -25.786)&gt;,
 &lt;Carbon Atom (C). Coordinates: (19.801, -26.707, -27.030)&gt;,
 &lt;Oxygen Atom (O). Coordinates: (20.438, -25.781, -27.539)&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">get_monomers</span><span class="p">())[:</span><span class="mi">20</span><span class="p">]</span>  <span class="c1"># Showing the first 20 elements for clarity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Residue containing 8 Atoms. Residue code: ASP&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ILE&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASP&gt;,
 &lt;Residue containing 7 Atoms. Residue code: THR&gt;,
 &lt;Residue containing 8 Atoms. Residue code: LEU&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ILE&gt;,
 &lt;Residue containing 6 Atoms. Residue code: SER&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASN&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASN&gt;,
 &lt;Residue containing 5 Atoms. Residue code: ALA&gt;,
 &lt;Residue containing 8 Atoms. Residue code: LEU&gt;,
 &lt;Residue containing 14 Atoms. Residue code: TRP&gt;,
 &lt;Residue containing 6 Atoms. Residue code: SER&gt;,
 &lt;Residue containing 9 Atoms. Residue code: LYS&gt;,
 &lt;Residue containing 8 Atoms. Residue code: MET&gt;,
 &lt;Residue containing 8 Atoms. Residue code: LEU&gt;,
 &lt;Residue containing 7 Atoms. Residue code: VAL&gt;,
 &lt;Residue containing 9 Atoms. Residue code: GLU&gt;,
 &lt;Residue containing 9 Atoms. Residue code: GLU&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASP&gt;]
</pre></div>
</div>
</div>
<div class="section" id="analysing-composition">
<h2>3. Analysing Composition<a class="headerlink" href="#analysing-composition" title="Permalink to this headline">¶</a></h2>
<p>We can easily look at the composition of sequences and structures using
a <code class="docutils literal"><span class="pre">Counter</span></code> object. <code class="docutils literal"><span class="pre">Counter</span></code> can be fed any iterable (<code class="docutils literal"><span class="pre">lists</span></code> and
<code class="docutils literal"><span class="pre">strings</span></code> are the most commonly used) and will count the occurence of
each element inside. We can start by looking at the composition of amino
acids in a sequence:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sequence</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;DIDTLISNNALWSKMLVEEDPGFFEKLAQAQKPRFLWIGCSDSRVPAERLTGLEPGELFVHRNVANLVIHTDLNCLSVVQYAVDVLEVEHIIICGHSGCGGIKAAVENPELGLINNWLLHIRDIWLKHSSLLGKMPEEQRLDALYELNVMEQVYNLGHSTIMQSAWKRGQNVTIHGWAYSINDGLLRDLDVTATNRETLENGYHKGISALSLKYI&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">(</span><span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
         <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
         <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
         <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
         <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
         <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
         <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
         <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
         <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
         <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
         <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
         <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
         <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
         <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
         <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
         <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
         <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
         <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
         <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
         <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
</pre></div>
</div>
<p>But as stated before, you can use Counters on any iterable, not just
strings. Let&#8217;s make a list of all the pdb molecule codes of the ligands:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligands</span> <span class="o">=</span> <span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">get_ligands</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Ligand containing 1 Atom. Ligand code: ZN&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mol_code</span>  <span class="c1"># This can be used to find the pdb molecule code of any residue</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;ZN&#39;</span>
</pre></div>
</div>
<p>There are two ways to generate a list of the codes, a <code class="docutils literal"><span class="pre">for</span></code> loop or a
<code class="docutils literal"><span class="pre">list</span></code> comprehension, use whichever you are comfortable with. If you&#8217;d
like to know more about <code class="docutils literal"><span class="pre">list</span></code> comprehensions, please see the
following link (this is relatively advanced Python but while not
essential for using any of the AMPAL framework, it is very useful: <a class="reference external" href="https://docs.python.org/3.5/tutorial/datastructures.html">List
Comprehensions</a>
(scroll down to the relevant section).</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># With a for loop</span>
<span class="n">mol_codes_1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lig</span> <span class="ow">in</span> <span class="n">my_ligands</span><span class="p">:</span>
    <span class="n">mol_codes_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lig</span><span class="o">.</span><span class="n">mol_code</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">mol_codes_1</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># The first 5 elements</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># A list comprehension</span>
<span class="n">mol_codes_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">lig</span><span class="o">.</span><span class="n">mol_code</span> <span class="k">for</span> <span class="n">lig</span> <span class="ow">in</span> <span class="n">my_ligands</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">mol_codes_2</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># Showing the first 5 elements for clarity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>You can use either of these methods, use whichever one you&#8217;re more
comfortable with.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">mol_codes_1</span> <span class="o">==</span> <span class="n">mol_codes_2</span>  <span class="c1"># The lists that re produced are exactly the same</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">True</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal"><span class="pre">list</span></code> of mol codes can be used to make a <code class="docutils literal"><span class="pre">Counter</span></code> object:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">(</span><span class="n">mol_codes_1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">({</span><span class="s1">&#39;HOH&#39;</span><span class="p">:</span> <span class="mi">447</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<p>As you can see, there are 447 water molecules and 2 zinc ions.</p>
</div>
<div class="section" id="distance-analysis">
<h2>4. Distance Analysis<a class="headerlink" href="#distance-analysis" title="Permalink to this headline">¶</a></h2>
<p>Now we can select all atoms in the protein and understand the structures
composition, we can perform some simple analysis. Let&#8217;s try and find all
the residues that are close to the zinc ions.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">zinc_1</span> <span class="o">=</span> <span class="n">my_ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">zinc_1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Ligand containing 1 Atom. Ligand code: ZN&gt;
</pre></div>
</div>
<p>All <code class="docutils literal"><span class="pre">Ligand</span></code> objects are <code class="docutils literal"><span class="pre">Monomers</span></code>, even if they only contain a
single atom. So we use the zinc <code class="docutils literal"><span class="pre">Atom</span></code> itself when measuring
distances:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Zinc Atom (ZN). Coordinates: (-5.817, -20.172, -18.798)&gt;
</pre></div>
</div>
<p>Measuring distances is simple, you can use the
<code class="docutils literal"><span class="pre">isambard.geometry.distance</span></code> function. It takes two 3D vectors as an
input, these can be in list form, tuples, or even <code class="docutils literal"><span class="pre">Atom</span></code> objects:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Distance from the origin</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">28.179990720367528</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">first_ca</span> <span class="o">=</span> <span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span>  <span class="c1"># CA of the first residue in chain A</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">first_ca</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Carbon Atom (CA). Coordinates: (15.518, -30.153, -25.207)&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">],</span> <span class="n">first_ca</span><span class="p">)</span>  <span class="c1"># Distance in angstroms</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">24.41060972200408</span>
</pre></div>
</div>
<p>Now we need to loop over all the atoms and find which are close (&lt;= 3 Å)
to the zinc. We can use the distance function in geometry to do this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">atoms_close_to_zinc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">],</span> <span class="n">at</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">3.0</span><span class="p">:</span>
        <span class="n">atoms_close_to_zinc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">atoms_close_to_zinc</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Sulfur Atom (SG). Coordinates: (-4.322, -18.933, -17.640)&gt;,
 &lt;Oxygen Atom (OD2). Coordinates: (-4.771, -22.057, -19.213)&gt;,
 &lt;Nitrogen Atom (NE2). Coordinates: (-6.209, -19.569, -20.787)&gt;,
 &lt;Sulfur Atom (SG). Coordinates: (-7.753, -20.619, -17.709)&gt;,
 &lt;Zinc Atom (ZN). Coordinates: (-5.817, -20.172, -18.798)&gt;]
</pre></div>
</div>
<p>There are 5 atoms within 3 Å of the zinc, <em>including</em> the zinc atom
itself. One way to get ignore this atom in the above block of code is to
use the <code class="docutils literal"><span class="pre">ligands=False</span></code> flag in <code class="docutils literal"><span class="pre">get_atoms()</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">atoms_close_to_zinc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">ligands</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">],</span> <span class="n">at</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">3.0</span><span class="p">:</span>
        <span class="n">atoms_close_to_zinc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">atoms_close_to_zinc</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Sulfur Atom (SG). Coordinates: (-4.322, -18.933, -17.640)&gt;,
 &lt;Oxygen Atom (OD2). Coordinates: (-4.771, -22.057, -19.213)&gt;,
 &lt;Nitrogen Atom (NE2). Coordinates: (-6.209, -19.569, -20.787)&gt;,
 &lt;Sulfur Atom (SG). Coordinates: (-7.753, -20.619, -17.709)&gt;]
</pre></div>
</div>
<p>Now there are 4 atoms within 3 Å of the zinc, 2 sulphur atoms, an oxygen
and a nitrogen. Let&#8217;s find the residues that are coordinating the zinc:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">atoms_close_to_zinc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Sulfur Atom (SG). Coordinates: (-4.322, -18.933, -17.640)&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">atoms_close_to_zinc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 6 Atoms. Residue code: CYS&gt;
</pre></div>
</div>
<p>We can get all the residues using a for loop or a list comprehension:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">residues_close_to_zinc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">atoms_close_to_zinc</span><span class="p">:</span>
    <span class="n">residues_close_to_zinc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">ampal_parent</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">residues_close_to_zinc</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Residue containing 6 Atoms. Residue code: CYS&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASP&gt;,
 &lt;Residue containing 10 Atoms. Residue code: HIS&gt;,
 &lt;Residue containing 6 Atoms. Residue code: CYS&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># The list comprehension is much more concise</span>
<span class="n">residues_close_to_zinc_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">at</span><span class="o">.</span><span class="n">ampal_parent</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">atoms_close_to_zinc</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">residues_close_to_zinc_2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Residue containing 6 Atoms. Residue code: CYS&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASP&gt;,
 &lt;Residue containing 10 Atoms. Residue code: HIS&gt;,
 &lt;Residue containing 6 Atoms. Residue code: CYS&gt;]
</pre></div>
</div>
<p>It looks like the zinc is coordinated by two cysteines, an aspartate and
a histidine residue.</p>
</div>
<div class="section" id="is-within">
<h2>5. Is Within<a class="headerlink" href="#is-within" title="Permalink to this headline">¶</a></h2>
<p>This kind of operation is very common when analysing proteins. So we
have some built-in methods for handling this on <code class="docutils literal"><span class="pre">Assembly</span></code> and
<code class="docutils literal"><span class="pre">Polymer</span></code> objects:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">is_within</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">])</span>  <span class="c1"># It takes a distance and a point</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Sulfur Atom (SG). Coordinates: (-4.322, -18.933, -17.640)&gt;,
 &lt;Oxygen Atom (OD2). Coordinates: (-4.771, -22.057, -19.213)&gt;,
 &lt;Nitrogen Atom (NE2). Coordinates: (-6.209, -19.569, -20.787)&gt;,
 &lt;Sulfur Atom (SG). Coordinates: (-7.753, -20.619, -17.709)&gt;,
 &lt;Zinc Atom (ZN). Coordinates: (-5.817, -20.172, -18.798)&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="o">.</span><span class="n">is_within</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Nitrogen Atom (N). Coordinates: (-7.278, -11.112, -10.445)&gt;,
 &lt;Carbon Atom (C). Coordinates: (-7.525, -10.089, -8.339)&gt;,
 &lt;Oxygen Atom (O). Coordinates: (-8.676, -9.655, -8.177)&gt;,
 &lt;Carbon Atom (CA). Coordinates: (-11.364, -9.364, -12.255)&gt;,
 &lt;Carbon Atom (CB). Coordinates: (-10.337, -10.223, -12.972)&gt;,
 &lt;Carbon Atom (CD). Coordinates: (-10.752, -12.047, -11.188)&gt;,
 &lt;Oxygen Atom (OE1). Coordinates: (-10.046, -11.618, -10.265)&gt;,
 &lt;Nitrogen Atom (ND2). Coordinates: (-11.667, -9.798, -7.931)&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_within</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Sulfur Atom (SG). Coordinates: (-4.322, -18.933, -17.640)&gt;,
 &lt;Oxygen Atom (OD2). Coordinates: (-4.771, -22.057, -19.213)&gt;,
 &lt;Nitrogen Atom (NE2). Coordinates: (-6.209, -19.569, -20.787)&gt;,
 &lt;Sulfur Atom (SG). Coordinates: (-7.753, -20.619, -17.709)&gt;,
 &lt;Zinc Atom (ZN). Coordinates: (-5.817, -20.172, -18.798)&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_within</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">zinc_1</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">])</span>
<span class="c1"># This list is empty as nothing on chain B is close to the zinc</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[]</span>
</pre></div>
</div>
<p>There is a partner method to is <code class="docutils literal"><span class="pre">is_within</span></code>, every <code class="docutils literal"><span class="pre">Monomer</span></code> (this
includes <code class="docutils literal"><span class="pre">Residues</span></code> and <code class="docutils literal"><span class="pre">Ligands</span></code>) has an <code class="docutils literal"><span class="pre">close_monomers</span></code> method.
This returns all <code class="docutils literal"><span class="pre">Monomers</span></code> within a given cutoff value.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">zinc_1</span><span class="o">.</span><span class="n">close_monomers</span><span class="p">(</span><span class="n">my_protein_3qy1</span><span class="p">)</span> <span class="c1"># default cutoff is 4.0 Å</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Residue containing 6 Atoms. Residue code: CYS&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASP&gt;,
 &lt;Residue containing 10 Atoms. Residue code: HIS&gt;,
 &lt;Residue containing 6 Atoms. Residue code: CYS&gt;,
 &lt;Ligand containing 1 Atom. Ligand code: ZN&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">zinc_1</span><span class="o">.</span><span class="n">close_monomers</span><span class="p">(</span><span class="n">my_protein_3qy1</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[&lt;Residue containing 6 Atoms. Residue code: CYS&gt;,
 &lt;Residue containing 6 Atoms. Residue code: SER&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASP&gt;,
 &lt;Residue containing 6 Atoms. Residue code: SER&gt;,
 &lt;Residue containing 11 Atoms. Residue code: ARG&gt;,
 &lt;Residue containing 7 Atoms. Residue code: VAL&gt;,
 &lt;Residue containing 5 Atoms. Residue code: ALA&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ASN&gt;,
 &lt;Residue containing 10 Atoms. Residue code: HIS&gt;,
 &lt;Residue containing 4 Atoms. Residue code: GLY&gt;,
 &lt;Residue containing 6 Atoms. Residue code: CYS&gt;,
 &lt;Residue containing 4 Atoms. Residue code: GLY&gt;,
 &lt;Residue containing 4 Atoms. Residue code: GLY&gt;,
 &lt;Residue containing 8 Atoms. Residue code: ILE&gt;,
 &lt;Ligand containing 1 Atom. Ligand code: ZN&gt;,
 &lt;Ligand containing 1 Atom. Ligand code: HOH&gt;,
 &lt;Ligand containing 1 Atom. Ligand code: HOH&gt;,
 &lt;Ligand containing 1 Atom. Ligand code: HOH&gt;,
 &lt;Ligand containing 1 Atom. Ligand code: HOH&gt;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">zinc_1</span><span class="o">.</span><span class="n">close_monomers</span><span class="p">(</span><span class="n">my_helices_3qy1</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Nothing is closer than 1 Å from the zinc</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="geometry-in-isambard">
<h2>6. Geometry in ISAMBARD<a class="headerlink" href="#geometry-in-isambard" title="Permalink to this headline">¶</a></h2>
<p>There are a range of tools in ISAMBARD for performing geometric
operations. We&#8217;ve already covered distance, but other commonly used
functions include <code class="docutils literal"><span class="pre">angle_between_vectors</span></code>, <code class="docutils literal"><span class="pre">dihedral</span></code>,
<code class="docutils literal"><span class="pre">unit_vector</span></code>, <code class="docutils literal"><span class="pre">find_foot</span></code>, <code class="docutils literal"><span class="pre">radius_of_circumcircle</span></code>. Be sure to
check out the source code if you need a specific geometric function or
have a look through the documentation.</p>
<p>The <code class="docutils literal"><span class="pre">dihedral</span></code> function is probably the most useful of these for
analysing proteins, so let&#8217;s use it to measure some torsion angles. It
requires 4 3D vectors to calculate the dihedral, again these can be
<code class="docutils literal"><span class="pre">lists</span></code>, <code class="docutils literal"><span class="pre">tuples</span></code>, <code class="docutils literal"><span class="pre">numpy.arrays</span></code> or <code class="docutils literal"><span class="pre">Atoms</span></code>. <strong>Note:</strong> This
method of calculating torsion angles is only as an example, see the
Tagging tutorial for the proper, low-effort method!</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">r1</span> <span class="o">=</span> <span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">my_protein_3qy1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">omega</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">r1</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="n">r1</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">phi</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">r1</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">r2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">r3</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">179.8002001034783</span> <span class="o">-</span><span class="mf">64.10861163046212</span> <span class="o">-</span><span class="mf">45.84373968479124</span>
</pre></div>
</div>
<p>We can use it to calculate the <span class="math">\(\chi\)</span> torsion angles too. R2 is
leucine, so we can calculate the <span class="math">\(\chi_1\)</span> and <span class="math">\(\chi_2\)</span>
angles:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">r2</span><span class="o">.</span><span class="n">atoms</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>OrderedDict([(&#39;N&#39;,
              &lt;Nitrogen Atom (N). Coordinates: (-5.186, -2.004, -31.807)&gt;),
             (&#39;CA&#39;,
              &lt;Carbon Atom (CA). Coordinates: (-4.911, -3.362, -31.310)&gt;),
             (&#39;C&#39;, &lt;Carbon Atom (C). Coordinates: (-5.985, -4.346, -31.786)&gt;),
             (&#39;O&#39;, &lt;Oxygen Atom (O). Coordinates: (-5.650, -5.434, -32.255)&gt;),
             (&#39;CB&#39;,
              &lt;Carbon Atom (CB). Coordinates: (-4.788, -3.418, -29.770)&gt;),
             (&#39;CG&#39;,
              &lt;Carbon Atom (CG). Coordinates: (-3.838, -2.437, -29.061)&gt;),
             (&#39;CD1&#39;,
              &lt;Carbon Atom (CD1). Coordinates: (-3.653, -2.831, -27.613)&gt;),
             (&#39;CD2&#39;,
              &lt;Carbon Atom (CD2). Coordinates: (-2.478, -2.359, -29.736)&gt;)])
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">chi1</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">r2</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CG&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">chi2</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CG&#39;</span><span class="p">],</span> <span class="n">r2</span><span class="p">[</span><span class="s1">&#39;CD1&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">51.38040366349739</span> <span class="o">-</span><span class="mf">168.70006206564494</span>
</pre></div>
</div>
<p>Our simple analysis shows that the leucine residue is in the
gauche-/trans conformation.</p>
</div>
<div class="section" id="summary-and-activities">
<h2>7. Summary and activities<a class="headerlink" href="#summary-and-activities" title="Permalink to this headline">¶</a></h2>
<p>There are lots of tools for making complex selections in ISAMBARD.
Combined with the tools for geometry, detailed analysis can be performed
on these selections.</p>
<ol class="arabic simple">
<li>Find all the residues that are:<ol class="arabic">
<li>within 5 Å of crystal water.</li>
<li><em>not</em> within 5 Å of crystal water.</li>
</ol>
</li>
<li>Find how many cis-peptide bonds there are in this structure.</li>
<li>Perform these activities on another PDB file.</li>
</ol>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="MakingModels.html" class="btn btn-neutral float-right" title="Making Models With Isambard" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1_AMPAL_Introduction_and_Selections.html" class="btn btn-neutral" title="An Introduction to the AMPAL Framework" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Woolfson Group.
      Last updated on August 16, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.4.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>