

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>An Introduction to the AMPAL Framework &mdash; ISAMBARD 1.4.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ISAMBARD 1.4.1 documentation" href="../index.html"/>
        <link rel="up" title="Tutorial" href="tutorial.html"/>
        <link rel="next" title="Advanced Selections and Analysis" href="2_Advanced_Selections_and_Analysis.html"/>
        <link rel="prev" title="Tutorial" href="tutorial.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ISAMBARD
          

          
          </a>

          
            
            
              <div class="version">
                2016.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">An Introduction to the AMPAL Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converting-pdb-files-to-ampal-objects">1. Converting PDB files to AMPAL Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-analysis">2. Basic Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-chains">3. Selecting Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-residues">4. Selecting Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-atoms">5. Selecting Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ampal-parents">6. AMPAL Parents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ligands">7. Ligands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary-and-activities">8. Summary and activities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_Advanced_Selections_and_Analysis.html">Advanced Selections and Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingModels.html">Making Models With Isambard</a></li>
<li class="toctree-l2"><a class="reference internal" href="AMPALTagging.html">Tagging in the AMPAL framework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing_isambard.html">Citing ISAMBARD</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ISAMBARD</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorial.html">Tutorial</a> &raquo;</li>
        
      <li>An Introduction to the AMPAL Framework</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/1_AMPAL_Introduction_and_Selections.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="an-introduction-to-the-ampal-framework">
<h1>An Introduction to the AMPAL Framework<a class="headerlink" href="#an-introduction-to-the-ampal-framework" title="Permalink to this headline">¶</a></h1>
<p>ISAMBARD represents proteins with Python objects that are part of the
AMPAL module. AMPAL stands for Atom, Monomer, Polymer, Assembly, Ligand;
which are the main functional elements of the framework. These objects
are designed to represent the hierarchical nature of proteins in an
intuitive way.</p>
<p>All protein models produced by ISAMBARD are AMPAL objects, but you can
also load in crystal structures.</p>
<blockquote>
<div><p><strong>Q. So why aren&#8217;t these objects just called Protein, Chain and
Residue?</strong></p>
<p>Well, there are <code class="docutils literal"><span class="pre">Polypeptide</span></code>, and <code class="docutils literal"><span class="pre">Residue</span></code> objects, but they
are just protein-specific versions of <code class="docutils literal"><span class="pre">Polymer</span></code> and <code class="docutils literal"><span class="pre">Monomer</span></code>.
We wanted to keep the base objects as generic as possible to allow
other biomolecules (like DNA or RNA), or even unnatural polymers
(like <span class="math">\(\beta\)</span>-amino acids) to be represented using this
architecture. While some these features are not currently
implemented in ISAMBARD, this will lead to more scalable code with
reduced duplication in the future.</p>
</div></blockquote>
<div class="section" id="converting-pdb-files-to-ampal-objects">
<h2>1. Converting PDB files to AMPAL Objects<a class="headerlink" href="#converting-pdb-files-to-ampal-objects" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">isambard</span>
</pre></div>
</div>
<p>Any PDB file can be parsed into an AMPAL object, which allows you to
easily analyse the structure. The only function you need for this is
<code class="docutils literal"><span class="pre">isambard.ampal.convert_pdb_to_ampal</span></code>. It takes a file path string as
the input argument:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">isambard</span><span class="o">.</span><span class="n">ampal</span><span class="o">.</span><span class="n">convert_pdb_to_ampal</span><span class="p">(</span><span class="s1">&#39;3qy1.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 2 Polypeptides, 449 Ligands&gt;
</pre></div>
</div>
<p>The object that is returned is an <code class="docutils literal"><span class="pre">Assembly</span></code>. We can assign it to a
variable and look inside it.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span> <span class="o">=</span> <span class="n">isambard</span><span class="o">.</span><span class="n">ampal</span><span class="o">.</span><span class="n">convert_pdb_to_ampal</span><span class="p">(</span><span class="s1">&#39;3qy1.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Remember if you are using the object in Jupyter Notebook once it&#8217;s
assigned to a variable, you can have a look at its attributes and
methods by typing <code class="docutils literal"><span class="pre">my_protein.</span></code> and then pressing tab.</p>
</div>
<div class="section" id="basic-analysis">
<h2>2. Basic Analysis<a class="headerlink" href="#basic-analysis" title="Permalink to this headline">¶</a></h2>
<p>This <code class="docutils literal"><span class="pre">Assembly</span></code> contains two <code class="docutils literal"><span class="pre">Polypeptides</span></code>, and 449 <code class="docutils literal"><span class="pre">Ligands</span></code>. It
is easy to check the amino acid sequences of the <code class="docutils literal"><span class="pre">Polypeptides</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="o">.</span><span class="n">sequences</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;DIDTLISNNALWSKMLVEEDPGFFEKLAQAQKPRFLWIGCSDSRVPAERLTGLEPGELFVHRNVANLVIHTDLNCLSVVQYAVDVLEVEHIIICGHSGCGGIKAAVENPELGLINNWLLHIRDIWLKHSSLLGKMPEEQRLDALYELNVMEQVYNLGHSTIMQSAWKRGQNVTIHGWAYSINDGLLRDLDVTATNRETLENGYHKGISALSLKYI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KDIDTLISNNALWSKMLVEEDPGFFEKLAQAQKPRFLWIGCSDSRVPAERLTGLEPGELFVHRNVANLVIHTDLNCLSVVQYAVDVLEVEHIIICGHSGCGGIKAAVENPELGLINNWLLHIRDIWLKHSSLLGKMPEEQRLDALYELNVMEQVYNLGHSTIMQSAWKRGQNVTIHGWAYSINDGLLRDLDVTATNRETLENGYHKGISALSLKYI&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">.sequences</span></code> attribute is a list of sequence strings, one for each
<code class="docutils literal"><span class="pre">Polymer</span></code>. We can determine other basic properties of the
<code class="docutils literal"><span class="pre">Assembly</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="o">.</span><span class="n">molecular_weight</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">48508.93158</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="o">.</span><span class="n">molar_extinction_280</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mi">83640</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="o">.</span><span class="n">isoelectric_point</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">5.4000000000000039</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;3qy1&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-chains">
<h2>3. Selecting Chains<a class="headerlink" href="#selecting-chains" title="Permalink to this headline">¶</a></h2>
<p>Items inside each <code class="docutils literal"><span class="pre">Assembly</span></code> object can be accessed analogously to
accessing items in a standard Python list:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># The first chain</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 215 Residues. Sequence: DIDTLISNNALW...&gt;
</pre></div>
</div>
<p>You can also select a <code class="docutils literal"><span class="pre">Polymer</span></code> using a string of the chain id from
the PDB file. In this case there are two chains &#8216;A&#8217; and &#8216;B&#8217;.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 215 Residues. Sequence: DIDTLISNNALW...&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 216 Residues. Sequence: KDIDTLISNNAL...&gt;
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">Polypeptide</span></code> object has a lot of the same functionality as the
<code class="docutils literal"><span class="pre">Assembly</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span> <span class="o">=</span> <span class="n">my_protein</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="o">.</span><span class="n">molecular_weight</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">24199.38728</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="o">.</span><span class="n">molar_extinction_280</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mi">41820</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="o">.</span><span class="n">isoelectric_point</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">5.4000000000000039</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;A&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-residues">
<h2>4. Selecting Residues<a class="headerlink" href="#selecting-residues" title="Permalink to this headline">¶</a></h2>
<p>Each <code class="docutils literal"><span class="pre">Polypeptide</span></code> object is made from one or more <code class="docutils literal"><span class="pre">Residue</span></code>
objects. You can access the <code class="docutils literal"><span class="pre">Residues</span></code> using square brackets:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 8 Atoms. Residue code: ASP&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 8 Atoms. Residue code: LEU&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 7 Atoms. Residue code: PRO&gt;
</pre></div>
</div>
<p>You can use a string of a residue id from the PDB file to select a
<code class="docutils literal"><span class="pre">Residue</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="p">[</span><span class="s1">&#39;23&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 7 Atoms. Residue code: PRO&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="p">[</span><span class="s1">&#39;40&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 8 Atoms. Residue code: ILE&gt;
</pre></div>
</div>
<p>If you use a residue number that isn&#8217;t defined in the PDB a <code class="docutils literal"><span class="pre">KeyError</span></code>
will be raised:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

KeyError                                  Traceback (most recent call last)

&lt;ipython-input-22-e01d62d6ac3a&gt; in &lt;module&gt;()
----&gt; 1 my_chain_a[&#39;2&#39;]


/Users/jackheal/Projects/isambard/isambard/ampal/protein.py in __getitem__(self, item)
    169         if isinstance(item, str):
    170             id_dict = {str(m.id): m for m in self._monomers}
--&gt; 171             return id_dict[item]
    172         elif isinstance(item, int):
    173             return self._monomers[item]


KeyError: &#39;2&#39;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span> <span class="o">=</span> <span class="n">my_chain_a</span><span class="p">[</span><span class="s1">&#39;23&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">Residues</span></code> contain an <code class="docutils literal"><span class="pre">OrderedDict</span></code> (a special type of
<code class="docutils literal"><span class="pre">dictionary</span></code> that retains the order you add elements) which has atom
identifiers and <code class="docutils literal"><span class="pre">Atom</span></code> objects all the atoms that make up the
<code class="docutils literal"><span class="pre">Residue</span></code>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="o">.</span><span class="n">atoms</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>OrderedDict([(&#39;N&#39;,
              &lt;Nitrogen Atom (N). Coordinates: (22.124, -4.140, -35.654)&gt;),
             (&#39;CA&#39;,
              &lt;Carbon Atom (CA). Coordinates: (22.664, -3.954, -34.292)&gt;),
             (&#39;C&#39;, &lt;Carbon Atom (C). Coordinates: (21.911, -2.875, -33.515)&gt;),
             (&#39;O&#39;, &lt;Oxygen Atom (O). Coordinates: (21.863, -2.926, -32.283)&gt;),
             (&#39;CB&#39;,
              &lt;Carbon Atom (CB). Coordinates: (24.120, -3.555, -34.534)&gt;),
             (&#39;CG&#39;,
              &lt;Carbon Atom (CG). Coordinates: (24.124, -2.964, -35.917)&gt;),
             (&#39;CD&#39;,
              &lt;Carbon Atom (CD). Coordinates: (23.118, -3.764, -36.681)&gt;)])
</pre></div>
</div>
</div>
<div class="section" id="selecting-atoms">
<h2>5. Selecting Atoms<a class="headerlink" href="#selecting-atoms" title="Permalink to this headline">¶</a></h2>
<p>Atoms can be selected using a string of their PDB atom type, for example
the C<span class="math">\(\alpha\)</span> atom of the residue can be selected like this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Carbon Atom (CA). Coordinates: (22.664, -3.954, -34.292)&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="p">[</span><span class="s1">&#39;CG&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Carbon Atom (CG). Coordinates: (24.124, -2.964, -35.917)&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Nitrogen Atom (N). Coordinates: (22.124, -4.140, -35.654)&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span> <span class="o">=</span> <span class="n">my_residue_A23</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The individual coordinates can be selected using square brackets:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">22.664000000000001</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">34.292000000000002</span>
</pre></div>
</div>
<p>Or with the <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code> and <code class="docutils literal"><span class="pre">z</span></code> properties:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mf">22.664000000000001</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">3.9540000000000002</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">z</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">34.292000000000002</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">Atom</span></code> object contains some useful attributes:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">id</span>  <span class="c1"># The atom number from the PDB file</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="mi">162</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">element</span>  <span class="c1"># The element of the atom</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;C&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="ampal-parents">
<h2>6. AMPAL Parents<a class="headerlink" href="#ampal-parents" title="Permalink to this headline">¶</a></h2>
<p>Hopefully you can see that it&#8217;s easy to traverse down the AMPAL
framework from <code class="docutils literal"><span class="pre">Assembly</span></code> level to the <code class="docutils literal"><span class="pre">Atom</span></code> level, but it&#8217;s just
as easy to work your way back up. With any AMPAL object you can use the
<code class="docutils literal"><span class="pre">ampal_parent</span></code> attribute to find the AMPAL object that it is contained
inside.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Residue containing 7 Atoms. Residue code: PRO&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 215 Residues. Sequence: DIDTLISNNALW...&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 2 Polypeptides, 449 Ligands&gt;
</pre></div>
</div>
<p>This attribute returns the original object itself, meaning you can
access all its methods and functions, including its own
<code class="docutils literal"><span class="pre">ampal_parent</span></code>!</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">ampal_parent</span> <span class="o">==</span> <span class="n">my_residue_A23</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">True</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="o">.</span><span class="n">ampal_parent</span> <span class="o">==</span> <span class="n">my_chain_a</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">True</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 215 Residues. Sequence: DIDTLISNNALW...&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 2 Polypeptides, 449 Ligands&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Assembly (3qy1) containing 2 Polypeptides, 449 Ligands&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_atom_A23ca</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;23&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_residue_A23</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">sequence</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;DIDTLISNNALWSKMLVEEDPGFFEKLAQAQKPRFLWIGCSDSRVPAERLTGLEPGELFVHRNVANLVIHTDLNCLSVVQYAVDVLEVEHIIICGHSGCGGIKAAVENPELGLINNWLLHIRDIWLKHSSLLGKMPEEQRLDALYELNVMEQVYNLGHSTIMQSAWKRGQNVTIHGWAYSINDGLLRDLDVTATNRETLENGYHKGISALSLKYI&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_chain_a</span><span class="o">.</span><span class="n">ampal_parent</span><span class="o">.</span><span class="n">sequences</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;DIDTLISNNALWSKMLVEEDPGFFEKLAQAQKPRFLWIGCSDSRVPAERLTGLEPGELFVHRNVANLVIHTDLNCLSVVQYAVDVLEVEHIIICGHSGCGGIKAAVENPELGLINNWLLHIRDIWLKHSSLLGKMPEEQRLDALYELNVMEQVYNLGHSTIMQSAWKRGQNVTIHGWAYSINDGLLRDLDVTATNRETLENGYHKGISALSLKYI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KDIDTLISNNALWSKMLVEEDPGFFEKLAQAQKPRFLWIGCSDSRVPAERLTGLEPGELFVHRNVANLVIHTDLNCLSVVQYAVDVLEVEHIIICGHSGCGGIKAAVENPELGLINNWLLHIRDIWLKHSSLLGKMPEEQRLDALYELNVMEQVYNLGHSTIMQSAWKRGQNVTIHGWAYSINDGLLRDLDVTATNRETLENGYHKGISALSLKYI&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="ligands">
<h2>7. Ligands<a class="headerlink" href="#ligands" title="Permalink to this headline">¶</a></h2>
<p>The last AMPAL objects to discuss are <code class="docutils literal"><span class="pre">Ligand</span></code> and <code class="docutils literal"><span class="pre">Ligands</span></code>. These
are intended to store non-protein elements from the PDB file. The
ligands can be extracted from the <code class="docutils literal"><span class="pre">Assembly</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_protein</span><span class="o">.</span><span class="n">get_ligands</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Ligands chain containing 449 Ligands&gt;
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">Ligands</span></code> is a special <code class="docutils literal"><span class="pre">Polymer</span></code> object, with none of the
protein-specific <code class="docutils literal"><span class="pre">Polypeptide</span></code> functionality. It contains one or more
<code class="docutils literal"><span class="pre">Ligand</span></code> objects which you can select in exactly the same way as
selecting <code class="docutils literal"><span class="pre">Residues</span></code> from <code class="docutils literal"><span class="pre">Polypeptides</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligands</span> <span class="o">=</span> <span class="n">my_protein</span><span class="o">.</span><span class="n">get_ligands</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Ligand containing 1 Atom. Ligand code: ZN&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligands</span><span class="p">[</span><span class="s1">&#39;221&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Ligand containing 1 Atom. Ligand code: ZN&gt;
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">Ligand</span></code> objects are <code class="docutils literal"><span class="pre">Monomer</span></code> objects, without the
protein-specific functionality that is present for <code class="docutils literal"><span class="pre">Residues</span></code>. Since
<code class="docutils literal"><span class="pre">Ligand</span></code> and <code class="docutils literal"><span class="pre">Residue</span></code> are both examples of <code class="docutils literal"><span class="pre">Monomer</span></code>, they have a
lot of the same functionality:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligand_zinc</span> <span class="o">=</span> <span class="n">my_ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligand_zinc</span><span class="o">.</span><span class="n">atoms</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>OrderedDict([(&#39;ZN&#39;,
              &lt;Zinc Atom (ZN). Coordinates: (-5.817, -20.172, -18.798)&gt;)])
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligand_zinc</span><span class="p">[</span><span class="s1">&#39;ZN&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Zinc Atom (ZN). Coordinates: (-5.817, -20.172, -18.798)&gt;
</pre></div>
</div>
<p>This zinc atom is associated with one of the <code class="docutils literal"><span class="pre">Polypeptide</span></code> chains, and
this is reflected in its <code class="docutils literal"><span class="pre">ampal_parent</span></code>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">my_ligand_zinc</span><span class="o">.</span><span class="n">ampal_parent</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;Polypeptide containing 215 Residues. Sequence: DIDTLISNNALW...&gt;
</pre></div>
</div>
</div>
<div class="section" id="summary-and-activities">
<h2>8. Summary and activities<a class="headerlink" href="#summary-and-activities" title="Permalink to this headline">¶</a></h2>
<p>With these simple methods you can load in a PDB file and select various
different parts of the protein. Please try playing around with the
example code and try to select different parts of the protein.</p>
<ol class="arabic simple">
<li>Try loading in a PDB file of your own and select various parts of the
protein and ligands.</li>
<li>Find the other builtin functions either by:<ol class="arabic">
<li>Tabbing the object in Jupyter Notebook</li>
<li>Looking at the documentation</li>
<li>Finding the <code class="docutils literal"><span class="pre">base_ampal</span></code> code in the ISAMBARD folder and looking
through it (tip: you can do this with the IPython file browser)</li>
</ol>
</li>
</ol>
<p>In the next section we&#8217;ll look at how we can perform more complex
selections and more detailed analysis on these objects.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2_Advanced_Selections_and_Analysis.html" class="btn btn-neutral float-right" title="Advanced Selections and Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial.html" class="btn btn-neutral" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Woolfson Group.
      Last updated on August 16, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.4.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>