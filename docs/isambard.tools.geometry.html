

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>isambard.tools.geometry module &mdash; ISAMBARD 1.4.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ISAMBARD 1.4.1 documentation" href="index.html"/>
        <link rel="up" title="isambard.tools package" href="isambard.tools.html"/>
        <link rel="next" title="isambard.tools.isambard_warnings module" href="isambard.tools.isambard_warnings.html"/>
        <link rel="prev" title="isambard.tools.file_parsing module" href="isambard.tools.file_parsing.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ISAMBARD
          

          
          </a>

          
            
            
              <div class="version">
                2016.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing_isambard.html">Citing ISAMBARD</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ISAMBARD</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="api_reference.html">API Reference</a> &raquo;</li>
        
          <li><a href="isambard.tools.html">isambard.tools package</a> &raquo;</li>
        
      <li>isambard.tools.geometry module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/isambard.tools.geometry.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="isambard-tools-geometry-module">
<h1>isambard.tools.geometry module<a class="headerlink" href="#isambard-tools-geometry-module" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-isambard.tools.geometry"></span><p>Cythonised versions of basic geometric operations that ISAMBARD requires.</p>
<p>If Cython is not detected the geometry module falls back to the Python
implementation. As a result, all functions that are available to the user MUST
return the same type the Python version of the code.</p>
<p>Functions that have names preceded by an underscore indicate that they are not
to be used by users. However, all of these functions will generally be defined
using cdef and so will not be imported anyway.</p>
<dl class="class">
<dt id="isambard.tools.geometry.Axis">
<em class="property">class </em><code class="descname">Axis</code><a class="headerlink" href="#isambard.tools.geometry.Axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#isambard.tools.geometry.Curve" title="isambard.tools.geometry.Curve"><code class="xref py py-class docutils literal"><span class="pre">isambard.tools.geometry.Curve</span></code></a></p>
<p>Axis: a straight line curve in 3-D space, defined by its start and end points (3-D vectors).</p>
<dl class="method">
<dt id="isambard.tools.geometry.Axis.arc_length">
<code class="descname">arc_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Axis.arc_length" title="Permalink to this definition">¶</a></dt>
<dd><p>arc length between point t and point t0</p>
<p class="rubric">Notes</p>
<p>This is a trivial function in this particular case. Implemented for compatability with Curve class.
Returns arc length along the curve between the points specified by t and t_ref.
If t_ref &gt; t then the returned value is negative.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>t_ref</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; t and t_ref define points on curve (See self.point()).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Axis.direction_vector">
<code class="descname">direction_vector</code><a class="headerlink" href="#isambard.tools.geometry.Axis.direction_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Axis.distance_to_point">
<code class="descname">distance_to_point</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Axis.distance_to_point" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Axis.get_coords">
<code class="descname">get_coords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Axis.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>List of evenly spaced points along the curve of specified total length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of points to be returned.</li>
<li><strong>spacing</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; arc-length spacing of points to be returned.</li>
<li><strong>t_ref</strong> (<em>The value of t for specifying the first point in the coordinates list.</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> &#8211;
3D coordinates of evenly spaced points along the curve.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of numpy.arrays</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Axis.length">
<code class="descname">length</code><a class="headerlink" href="#isambard.tools.geometry.Axis.length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Axis.midpoint">
<code class="descname">midpoint</code><a class="headerlink" href="#isambard.tools.geometry.Axis.midpoint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Axis.point">
<code class="descname">point</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Axis.point" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Axis.t_from_arc_length">
<code class="descname">t_from_arc_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Axis.t_from_arc_length" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Returns parameter t that corresponds to a point at distance=arc_length along the curve from the curve</dt>
<dd>at t_ref.</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a trivial function in this particular case. Implemented for compatability with Curve class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arc_length</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; distance along curve</li>
<li><strong>t_ref</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of parameter t that corresponds to a point at distance=arc_length along the curve from the point
defined by parameter t_ref.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Axis.unit_binormal">
<code class="descname">unit_binormal</code><a class="headerlink" href="#isambard.tools.geometry.Axis.unit_binormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Binormal defined as (Tangent X Normal).</p>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Axis.unit_normal">
<code class="descname">unit_normal</code><a class="headerlink" href="#isambard.tools.geometry.Axis.unit_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Normal is perpendicular to tangent. See notes.</p>
<p class="rubric">Notes</p>
<p>Since the curvature of a straight line is zero, the normal and binormal are not well-defined.
<a class="reference external" href="https://en.wikipedia.org/wiki/Differential_geometry_of_curves#Special_Frenet_vectors_and_generalized_curvatures">https://en.wikipedia.org/wiki/Differential_geometry_of_curves#Special_Frenet_vectors_and_generalized_curvatures</a>
Here we have chosen to use the following convention:</p>
<blockquote>
<div><dl class="docutils">
<dt>If the Axis is parallel to the z-axis (i.e. unit_tangent = [0, 0, 1]),</dt>
<dd>then the normal is [1, 0, 0] (x-axis) and the binormal is [0, 1, 0] (y-axis).</dd>
</dl>
<p>If the Axis is not parallel to the z-axis, then we can rotate the z-axis so it aligns with our Axis.
The normal is the same rotation appled to the x-axis.
It&#8217;s helpful here to think of the right-hand rule.
<a class="reference external" href="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Right_hand_rule_cross_product.svg/2000px-Right_hand_rule_cross_product.svg.png">https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Right_hand_rule_cross_product.svg/2000px-Right_hand_rule_cross_product.svg.png</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Cross_product#Definition">https://en.wikipedia.org/wiki/Cross_product#Definition</a>
Using the right-hand rule, the Axis direction vector is your index finger,
the normal vector is the middle finger and the binormal is the thumb.</p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Axis.unit_tangent">
<code class="descname">unit_tangent</code><a class="headerlink" href="#isambard.tools.geometry.Axis.unit_tangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Tangent points along the direction of the line.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="isambard.tools.geometry.Curve">
<em class="property">class </em><code class="descname">Curve</code><a class="headerlink" href="#isambard.tools.geometry.Curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Not intended to be instantiated. This is a base class for other Curve classes to inherit from.</p>
<p class="rubric">Notes</p>
<p>Any curve must have a point method, which returns the coordinates of a point, given a parameter t.</p>
<dl class="method">
<dt id="isambard.tools.geometry.Curve.point">
<code class="descname">point</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Curve.point" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="isambard.tools.geometry.HelicalCurve">
<em class="property">class </em><code class="descname">HelicalCurve</code><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#isambard.tools.geometry.Curve" title="isambard.tools.geometry.Curve"><code class="xref py py-class docutils literal"><span class="pre">isambard.tools.geometry.Curve</span></code></a></p>
<p>HelicalCurve, parameterised by a and b.</p>
<dl class="attribute">
<dt id="isambard.tools.geometry.HelicalCurve.alpha">
<code class="descname">alpha</code><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Angle between tangent to helix and the helix axis, in degrees.</p>
</dd></dl>

<dl class="classmethod">
<dt id="isambard.tools.geometry.HelicalCurve.alpha_and_pitch">
<em class="property">classmethod </em><code class="descname">alpha_and_pitch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.alpha_and_pitch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="isambard.tools.geometry.HelicalCurve.alpha_and_radius">
<em class="property">classmethod </em><code class="descname">alpha_and_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.alpha_and_radius" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.arc_length">
<code class="descname">arc_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.arc_length" title="Permalink to this definition">¶</a></dt>
<dd><p>arc length between point t and point t0</p>
<p class="rubric">Notes</p>
<p>Returns arc length along the curve between the points specified by t and t_ref.
If t_ref &gt; t then the returned value is negative.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>t_ref</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; t and t_ref define points on curve (See self.point()).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.HelicalCurve.axis">
<code class="descname">axis</code><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.axis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.curvature">
<code class="descname">curvature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.curvature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.get_coords">
<code class="descname">get_coords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>List of evenly spaced points along the curve of specified total length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of points to be returned.</li>
<li><strong>spacing</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; arc-length spacing of points to be returned.</li>
<li><strong>axis_start</strong> (<em>list or tuple or numpy.array of length 3</em>) &#8211; </li>
<li><strong>axis_end</strong> (<em>list or tuple or numpy.array of length 3</em>) &#8211; Coordinates returned will be for a helical path winding around an axis specified by axis_end - axis_start.</li>
<li><strong>t_ref</strong> (<em>The value of t for specifying the first point in the coordinates list.</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> &#8211;
3D coordinates of evenly spaced points along the curve.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of numpy.arrays</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.HelicalCurve.pitch">
<code class="descname">pitch</code><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.pitch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="isambard.tools.geometry.HelicalCurve.pitch_and_radius">
<em class="property">classmethod </em><code class="descname">pitch_and_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.pitch_and_radius" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.point">
<code class="descname">point</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.point" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.HelicalCurve.radius">
<code class="descname">radius</code><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.radius" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.t_from_arc_length">
<code class="descname">t_from_arc_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.t_from_arc_length" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Returns parameter t that corresponds to a point at distance=arc_length along the curve from the curve</dt>
<dd>at t_ref.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arc_length</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; distance along curve</li>
<li><strong>t_ref</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of parameter t that corresponds to a point at distance=arc_length along the curve from the point
defined by parameter t_ref.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.torsion">
<code class="descname">torsion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.torsion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.unit_binormal">
<code class="descname">unit_binormal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.unit_binormal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.unit_normal">
<code class="descname">unit_normal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.unit_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit vector normal to the curve. Together with unit_tangent, defined the osculating plane at t</p>
<p class="rubric">Notes</p>
<p>See this article for more information on the tangent, normal and binormal vectors.
<a class="reference external" href="https://en.wikipedia.org/wiki/Differential_geometry_of_curves#Special_Frenet_vectors_and_generalized_curvatures">https://en.wikipedia.org/wiki/Differential_geometry_of_curves#Special_Frenet_vectors_and_generalized_curvatures</a></p>
</dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.unit_tangent">
<code class="descname">unit_tangent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.unit_tangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit vector pointing along the direction of the curve.</p>
</dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.x">
<code class="descname">x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.y">
<code class="descname">y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.y" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.HelicalCurve.z">
<code class="descname">z</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.HelicalCurve.z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="isambard.tools.geometry.Quaternion">
<em class="property">class </em><code class="descname">Quaternion</code><a class="headerlink" href="#isambard.tools.geometry.Quaternion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="classmethod">
<dt id="isambard.tools.geometry.Quaternion.angle_and_axis">
<em class="property">classmethod </em><code class="descname">angle_and_axis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.angle_and_axis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Quaternion.apply_conjugation">
<code class="descname">apply_conjugation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.apply_conjugation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Quaternion.as_array">
<code class="descname">as_array</code><a class="headerlink" href="#isambard.tools.geometry.Quaternion.as_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Quaternion.as_rotation">
<code class="descname">as_rotation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.as_rotation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Quaternion.conjugate">
<code class="descname">conjugate</code><a class="headerlink" href="#isambard.tools.geometry.Quaternion.conjugate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Quaternion.distance">
<code class="descname">distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Quaternion.extract_angle_and_axis">
<code class="descname">extract_angle_and_axis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.extract_angle_and_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the angle and axis of the rotation that the Quaternion represents.</p>
</dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Quaternion.norm">
<code class="descname">norm</code><a class="headerlink" href="#isambard.tools.geometry.Quaternion.norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="isambard.tools.geometry.Quaternion.real_and_vector">
<em class="property">classmethod </em><code class="descname">real_and_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.real_and_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="isambard.tools.geometry.Quaternion.rotate_vector">
<code class="descname">rotate_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.Quaternion.rotate_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="isambard.tools.geometry.Quaternion.vector">
<code class="descname">vector</code><a class="headerlink" href="#isambard.tools.geometry.Quaternion.vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.angle_between_vectors">
<code class="descname">angle_between_vectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.angle_between_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate angle between two vectors using the dot product.</p>
<p class="rubric">Notes</p>
<p>All angle-based functions in tools_geometry will return values in degrees by default.
The radians flag can be used to return values in radians.
If a or b is very close to the origin (norm &lt; 1e-7), returns 0.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>list or tuple or numpy.array.</em>) &#8211; </li>
<li><strong>b</strong> (<em>list or tuple or numpy.array.</em>) &#8211; </li>
<li><strong>radians</strong> (<em>bool, optional</em>) &#8211; If True, returns angle in radians.
If False, returns angle in degrees.
Default value is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>angle</strong> &#8211;
The angle between vectors v1 and v2.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">double</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.apply_unit_quaternion">
<code class="descname">apply_unit_quaternion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.apply_unit_quaternion" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the rotation defined by the unit quaternion to a 3D vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vector</strong> (<em>[float, float, float]</em>) &#8211; 3D coordinate.</li>
<li><strong>u_in</strong> (<em>double[3]</em>) &#8211; Imaginary component of the unit quaternion.</li>
<li><strong>s</strong> (<em>double</em>) &#8211; Real component of the quaternion.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>r</strong> &#8211;
3D coordinate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">double[3]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.cartesian_to_cylindrical">
<code class="descname">cartesian_to_cylindrical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.cartesian_to_cylindrical" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from cartesian to cylindrical coordinates system</p>
<p class="rubric">Notes</p>
<p>See cylindrical_to_cartesian for more information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>z</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>radians</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; True if returned azimuth is in radians instead of degrees.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>radius</strong> (<em>float</em>)</li>
<li><strong>azimuth</strong> (<em>float</em>)</li>
<li><strong>z</strong> (<em>float</em>) &#8211;
Cylindrical coordinate parameters. See cylindrical_to_cartesian for more information.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.cartesian_to_spherical">
<code class="descname">cartesian_to_spherical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.cartesian_to_spherical" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from cartesian to spherical coordinates system</p>
<p class="rubric">Notes</p>
<p>See spherical_to_cartesian for more information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>z</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>radians</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; True if returned azimuth and zenith are in radians instead of degrees.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>radius</strong> (<em>float</em>)</li>
<li><strong>azimuth</strong> (<em>float</em>)</li>
<li><strong>zenith</strong> (<em>float</em>) &#8211;
Spherical coordinate parameters. See spherical_to_cartesian for more information.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.centre_of_mass">
<code class="descname">centre_of_mass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.centre_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Find centre of mass of list of points.</p>
<p class="rubric">Notes</p>
<p>Uniform weighting applied if masses not supplied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points</strong> (<em>list(tuple, list or numpy.array)</em>) &#8211; </li>
<li><strong>masses</strong> (<em>list(float)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>com</strong> &#8211;
Centre of mass of points.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy.array</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> &#8211;
if len(masses) != len(points)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.closest_distance">
<code class="descname">closest_distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.closest_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimun distance between two lists of points in R^3.</p>
<p>Distances are calculated pairwise between points in points1 and points2.
The minimum of all these distance values is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points1</strong> (<em>list or tuple or numpy.array of triples.</em>) &#8211; A number of points in R^3.</li>
<li><strong>points2</strong> (<em>list or tuple or numpy.array of triples.</em>) &#8211; A number of points in R^3.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>min_dist</strong> &#8211;
The minimum distance between any point from points1 and any point from point2.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.closest_points_on_lines">
<code class="descname">closest_points_on_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.closest_points_on_lines" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p>p0, p1, q0, q1 describe two lines, L1 (p0 -&gt; p1) and L2 (q0 -&gt; q1).
L1 (2) is the infinite extension of the line that passes through a (q0) and has direction p0-&gt;p1 (q0-&gt;q1).
Two points point_1, and point_2 on L1 and L2 respectively, are returned.
The distance between point_1 and point_2 is smaller than any other points on L1 and L2.
Code adapted from <a class="reference external" href="http://geomalgorithms.com/a07-_distance.html">http://geomalgorithms.com/a07-_distance.html</a>, where a more detailed explanation is available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p0</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>p1</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>q0</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>q1</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>segments</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, the points returned must lie on line segments p0-&gt;p1 and q0-&gt;q1, rather than their infinite extensions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>point_1</strong> (<em>numpy.array</em>)</li>
<li><strong>point_2</strong> (<em>numpy.array</em>)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.cylindrical_to_cartesian">
<code class="descname">cylindrical_to_cartesian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.cylindrical_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from cylindrical to cartesian coordinates system</p>
<p class="rubric">Notes</p>
<p>Cylindrical coordinates are here defined by a radius, an azimuth angle and a z value.
The azimuth is the angle in the x-y plane, with counter-clockwise direction being positive.
So: azimuth = 0 =&gt; lies on x-axis, azimuth = 90 =&gt; lies in y axis, zenith = 180 =&gt; lies antiparallel to x-axis.
The radius and the z value are the radius and height of the cylinder, respectively.
See <a class="reference external" href="https://en.wikipedia.org/wiki/Cylindrical_coordinate_system">https://en.wikipedia.org/wiki/Cylindrical_coordinate_system</a>
and/or <a class="reference external" href="http://mathworld.wolfram.com/CylindricalCoordinates.html">http://mathworld.wolfram.com/CylindricalCoordinates.html</a>
for more information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>azimuth</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>z</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>radians</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; True if azimuth is given in radians instead of degrees.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cartesian coordinates corresponding to the input cylindrical coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array([x, y, z])</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.dihedral">
<code class="descname">dihedral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the dihedral angle defined by four points in R^3.</p>
<p>The points a, b and c form a plane in R^3.
The points b, c and d form a plane in R^3.
The dihedral angle is the angle between these two planes.</p>
<p class="rubric">Notes</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Dihedral_angle">http://en.wikipedia.org/wiki/Dihedral_angle</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Atan2">https://en.wikipedia.org/wiki/Atan2</a> for more information.
Dihedral between 4 points.
a, b, c, d are all 3-vectors (x,y,z) coordinates.
(a,b,c) and (b,c,d) must both be non-colinear.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>b</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>c</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>d</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>radians</strong> (<em>bool, optional</em>) &#8211; If True, returns angle in radians.
If False, returns angle in degrees.
Default value is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>angle</strong> &#8211;
The dihedral angle formed between the points a, b, c and d.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">double</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.distance">
<code class="descname">distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Euclidian distance between two points in R^3.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>b</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dist</strong> &#8211;
Euclidean distance between a and b.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">double</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.find_foot">
<code class="descname">find_foot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.find_foot" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the perpendicular foot of a point (p) and a line (ab).</p>
<p>The points a and b define a line in R^3.
There is a point on this line, q, that has the shortest Euclidian distance from the point p.
This point is the perpendicular foot, and is returned by this function.</p>
<p class="rubric">Notes</p>
<p>See <a class="reference external" href="http://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html">http://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html</a> for a useful work-through of the maths.
Parameterise the line ab by t, so that a point on the line is of the form: a + (b-a)*t.
Define f(t) = [distance(t, p)]^2. Want t such that f(t) is at a minimum.
Solve f&#8217;(t) = 0 for t.
Substituting this value of t into a + (b-a)*t yields the desired point q.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>b</strong> (<em>list or tuple or numpy.array</em>) &#8211; Together, the points a and b define a line in R^3.</li>
<li><strong>p</strong> (<em>list or tuple or numpy.array</em>) &#8211; A point in R^3.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>q</strong> &#8211;
The point on the line between a and b that is closest to q.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list or tuple or numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.find_foot_on_plane">
<code class="descname">find_foot_on_plane</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.find_foot_on_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the perpendicular foot of a point (p) and a plane defined by points a, b and c.</p>
<p>The points a, b and c must define a plane in R^3 (i.e. they cannot be collinear).
There is a point on this plane, q, that has the shortest Euclidian distance from the point p.
This point is the perpendicular foot, and is returned by this function.</p>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>This page:</dt>
<dd><a class="reference external" href="http://math.stackexchange.com/questions/723937/find-the-point-on-a-plane-3x-4y-z-1-that-is-closest-to-1-0-1">http://math.stackexchange.com/questions/723937/find-the-point-on-a-plane-3x-4y-z-1-that-is-closest-to-1-0-1</a>
gives a work-through of this kind of problem for a specific example.</dd>
</dl>
<p>The solution uses the Lagrangian multiplier: <a class="reference external" href="https://en.wikipedia.org/wiki/Lagrange_multiplier">https://en.wikipedia.org/wiki/Lagrange_multiplier</a>
We look for the minimum values of the distance function f (squared to make it easier!)</p>
<blockquote>
<div>f(x, y, z) = (x - p[0])^2 + (y - p[1])^2 + (z - p[2])^2</div></blockquote>
<p>subject to the constraint g(x, y, z) = 0, where g is the equation of the plane.
The Langrangian multiplier L = f(x, y, z) - lambda*(g(x, y, z)).
We calculate the partial deriviatves of this (wrt x, y, z and lambda).
Solve first for lambda gives the equation for the lagrangian_lambda value in this function.
Then substitute lambda back in to get the solution for (x, y, z) = q.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>b</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>c</strong> (<em>list or tuple or numpy.array</em>) &#8211; Together, the points a, b and c define a plane in R^3.</li>
<li><strong>p</strong> (<em>list or tuple or numpy.array</em>) &#8211; A point in R^3.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>s</strong> &#8211;
The point on the plane that is closest to q.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.find_limits">
<code class="descname">find_limits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.find_limits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.find_transformations">
<code class="descname">find_transformations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.find_transformations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns geometrical transformations required to align the vector from s1 -&gt; e1 with the vector from s2 -&gt; e2</p>
<p class="rubric">Notes</p>
<p>Applying the transformations returned to the line from s1 -&gt; e2, will align it with the line from s2 -&gt; e2.
After transformation, s1 will have been moved onto s2.
Apply the rotation (given by angle, axis and point) first and then the translation (given by translation).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s1</strong> (<em>[float, float, float]</em>) &#8211; 3D coordinate. Start of line 1</li>
<li><strong>e1</strong> (<em>[float, float, float]</em>) &#8211; 3D coordinate. End of line 1</li>
<li><strong>s2</strong> (<em>[float, float, float]</em>) &#8211; 3D coordinate. Start of line 2</li>
<li><strong>e2</strong> (<em>[float, float, float]</em>) &#8211; 3D coordinate. End of line 2</li>
<li><strong>radians</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, angle will be returned in radians.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>translation</strong> (<em>numpy.array(3)</em>) &#8211;
3D vector. Translation to be applied to s1 to move it onto s2.</li>
<li><strong>angle</strong> (<em>float</em>) &#8211;
angle for rotation (default: degrees).</li>
<li><strong>axis</strong> (<em>numpy.array(3)</em>) &#8211;
axis about which to rotate line 1 to align it with line 2.</li>
<li><strong>point</strong> (<em>numpy.array(3)</em>) &#8211;
a point lying on the rotation axis.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.gen_sectors">
<code class="descname">gen_sectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.gen_sectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Separates the coordinates into overlapping sectors.</p>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.intersection_start_and_end">
<code class="descname">intersection_start_and_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.intersection_start_and_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Find start and end indices of the part of the list of points &#8216;subject&#8217; that will intersect with &#8216;reference&#8217;</p>
<p class="rubric">Notes</p>
<p>This is a function designed to find assemblies from within bundles of helices.
The idea here is to take two lists of points, a subject and a reference. We want to find the part of the subject
(this could be all of it, or none of it) that would intersect the line joining the points in the reference, if
the line joining the points of subject was the prinicipal axis of a cylinder of infinite radius.
If subject was a list of ten points joining (0, 0 , 0) and (0, 0, 10), and reference was a list of 1000 points
joining (10, 0, 7) and (10, 0, 12) this function would return (7, 10).
If the subject and reference for the above example were swapped around, however, the function would return (0, 599).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>subject</strong> (<em>list of numpy.array</em>) &#8211; A list of points in R^3.</li>
<li><strong>reference</strong> (<em>list of numpy.array</em>) &#8211; A list of points in R^3.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>start_index</strong> (<em>int</em>) &#8211;
The index of the first point in subject that is part of the intersection described above.</li>
<li><strong>end_index</strong> (<em>int</em>) &#8211;
The index of the final point in subject that is part of the intersection described above.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.is_acute">
<code class="descname">is_acute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.is_acute" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if angle between two vectors is less than 90 degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>b</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if angle between v1 and v2 is less than 90 degrees.
False otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)">bool</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.minimal_distance_between_lines">
<code class="descname">minimal_distance_between_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.minimal_distance_between_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the minimal distance between two the two lines joining p0 to p1 and q0 to q1.</p>
<p>The points p0, p1, q0 and d are used to construct two lines in R^3.
The first line L1 is from p0 to p1, the second line L2 is from q0 to q1.
The minimal distance between these lines is the length of the line that
connects them and is perpendicular to both L1 and L2.</p>
<p class="rubric">Notes</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Skew_lines#Distance">https://en.wikipedia.org/wiki/Skew_lines#Distance</a> for more information.
Also <a class="reference external" href="http://geomalgorithms.com/a07-_distance.html">http://geomalgorithms.com/a07-_distance.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p0</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>p1</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>q0</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>q1</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>segments</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, the points returned must lie on line segments p0-&gt;p1 and q0-&gt;q1, rather than their infinite extensions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dist</strong> &#8211;
The distance between the two lines.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.points_on_a_circle">
<code class="descname">points_on_a_circle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.points_on_a_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>List of n uniformly distributed (x, y) coordinates on the circumference of a circle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of points to return.</li>
<li><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>centre</strong> (<em>tuple or list or numpy.array</em>) &#8211; </li>
<li><strong>rotation</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Angle in degrees by which all points will be rotated.
rotation = 0 means that the line from the centre to the first point is parallel to the x-axis.
rotation &gt; 0 =&gt; anti-clockwise rotation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>points</strong> &#8211;
(x, y) coordinates of uniformly distributed points on the circumference of the circle</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list(2-tuples)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.radius_of_circumcircle">
<code class="descname">radius_of_circumcircle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.radius_of_circumcircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the radius the circumcircle of a triangle, when supplied with three points (p, q, r).</p>
<p class="rubric">Notes</p>
<p>See <a class="reference external" href="http://www.analyzemath.com/Geometry/Circumcircle/CircumcircleRadius.html">http://www.analyzemath.com/Geometry/Circumcircle/CircumcircleRadius.html</a>
for more information.
Three (non-colinear) points define a traingle.
The circumcircle is the circle that passes though these points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>q</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
<li><strong>r</strong> (<em>list or tuple or numpy.array</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>radius</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.rmsd">
<code class="descname">rmsd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns average distance between points in points1 and their counterparts in points2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points1</strong> (<em>list of [float, float, float]</em>) &#8211; </li>
<li><strong>points2</strong> (<em>list of [float, float, float]</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rmsd</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> (<em>if len(points1) != len(points2)</em>) &#8211;</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.rotation_matrix">
<code class="descname">rotation_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Find rotation matrix for rotating about unit_vect by angle.</p>
<p class="rubric">Notes</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">https://en.wikipedia.org/wiki/Rotation_matrix</a> for more information.
In particular, the section headed &#8216;Rotation matrix from axis and angle&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Angle about which to rotate.</li>
<li><strong>unit_vect</strong> (<em>list or tuple or numpy.array</em>) &#8211; Vector about which to rotate.</li>
<li><strong>point</strong> (<em>list or tuple or numpy.array, optional.</em>) &#8211; Specify a point about which to rotate.
If point is None, then the rotation will be about the origin.
Default value is None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m</strong> &#8211;
A (4 x 4) rotation matrix.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.spherical_to_cartesian">
<code class="descname">spherical_to_cartesian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.spherical_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from spherical to cartesian coordinates system</p>
<p class="rubric">Notes</p>
<p>Spherical coordinates are here defined by a radius, an azimuth angle and a zenith angle.
The zenith is the angle between the point and the z-axis.
So: zenith = 0 =&gt; lies on z-axis, zenith = 90 =&gt; lies in x-y plane, zenith = 180 =&gt; lies antiparallel to z-axis.
The azimuth is the angle in the x-y plane, with counter-clockwise direction being positive.
So: azimuth = 0 =&gt; lies on x-axis, azimuth = 90 =&gt; lies in y axis, zenith = 180 =&gt; lies antiparallel to x-axis.
See <a class="reference external" href="https://en.wikipedia.org/wiki/Spherical_coordinate_system">https://en.wikipedia.org/wiki/Spherical_coordinate_system</a>
and/or <a class="reference external" href="http://mathworld.wolfram.com/SphericalCoordinates.html">http://mathworld.wolfram.com/SphericalCoordinates.html</a>
for more information.
If zenith = 0, then x and y are both 0 regardless of azimuth value.
If azimuth = 0, then y is 0 regardless of zenith value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>azimuth</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>zenith</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; </li>
<li><strong>radians</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; True if azimuth and zenith are given in radians instead of degrees.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cartesian coordinates corresponding to the input spherical coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array([x, y, z])</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="isambard.tools.geometry.unit_vector">
<code class="descname">unit_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#isambard.tools.geometry.unit_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return vector normalised by length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a</strong> (<em>list or tuple or numpy.array</em>) &#8211; The vector to be normalised.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>v_out</strong> &#8211;
A numpy.array that is a unit vector.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">ZeroDivisionError</span></code> &#8211;
If the vector has length 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="isambard.tools.isambard_warnings.html" class="btn btn-neutral float-right" title="isambard.tools.isambard_warnings module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="isambard.tools.file_parsing.html" class="btn btn-neutral" title="isambard.tools.file_parsing module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Woolfson Group.
      Last updated on August 16, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.4.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>